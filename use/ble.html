<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>BLE gateway | OpenMQTTGateway</title>
    <meta name="description" content="One gateway, many technologies">
    
    
    <link rel="preload" href="/assets/css/0.styles.e330e0e9.css" as="style"><link rel="preload" href="/assets/js/app.55b55a57.js" as="script"><link rel="preload" href="/assets/js/2.e0da9a0a.js" as="script"><link rel="preload" href="/assets/js/15.6c1a5c94.js" as="script"><link rel="prefetch" href="/assets/js/10.41aee2ae.js"><link rel="prefetch" href="/assets/js/11.0524965f.js"><link rel="prefetch" href="/assets/js/12.83b140f1.js"><link rel="prefetch" href="/assets/js/13.78664f8c.js"><link rel="prefetch" href="/assets/js/14.924ee4e9.js"><link rel="prefetch" href="/assets/js/16.9f4a04cc.js"><link rel="prefetch" href="/assets/js/17.6e428635.js"><link rel="prefetch" href="/assets/js/18.f2b488ca.js"><link rel="prefetch" href="/assets/js/19.c7df2ff7.js"><link rel="prefetch" href="/assets/js/20.16caa018.js"><link rel="prefetch" href="/assets/js/21.7f67003b.js"><link rel="prefetch" href="/assets/js/22.d6543650.js"><link rel="prefetch" href="/assets/js/23.a9c5199e.js"><link rel="prefetch" href="/assets/js/24.f3656602.js"><link rel="prefetch" href="/assets/js/25.2f423192.js"><link rel="prefetch" href="/assets/js/26.2284c1b9.js"><link rel="prefetch" href="/assets/js/27.8fb61df5.js"><link rel="prefetch" href="/assets/js/28.1ce5f6a2.js"><link rel="prefetch" href="/assets/js/29.643cdc91.js"><link rel="prefetch" href="/assets/js/3.911d0f75.js"><link rel="prefetch" href="/assets/js/30.501f0c92.js"><link rel="prefetch" href="/assets/js/31.a0fcd343.js"><link rel="prefetch" href="/assets/js/4.7a8d47bf.js"><link rel="prefetch" href="/assets/js/5.e3c9d828.js"><link rel="prefetch" href="/assets/js/6.2e1ae3f6.js"><link rel="prefetch" href="/assets/js/7.39248e63.js"><link rel="prefetch" href="/assets/js/8.708e107d.js"><link rel="prefetch" href="/assets/js/9.75ac40cd.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e330e0e9.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">OpenMQTTGateway</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://1technophile.blogspot.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Blog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/" class="nav-link">Docs</a></div><div class="nav-item"><a href="https://community.openmqttgateway.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Community
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://docs.google.com/spreadsheets/d/1_5fQjAixzRtepkykmL-3uN3G5bLfQ0zMajM9OBZ1bx0/edit#gid=2126158079" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Devices
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/1technophile/OpenMQTTGateway" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://1technophile.blogspot.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Blog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/" class="nav-link">Docs</a></div><div class="nav-item"><a href="https://community.openmqttgateway.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Community
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://docs.google.com/spreadsheets/d/1_5fQjAixzRtepkykmL-3uN3G5bLfQ0zMajM9OBZ1bx0/edit#gid=2126158079" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Devices
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/1technophile/OpenMQTTGateway" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/" class="sidebar-link">0 - What is it for üè†</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/prerequisites/devices/" class="sidebar-heading clickable"><span>1 - Prerequisitesüß≠</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/setitup/rf" class="sidebar-heading clickable"><span>2 - Set it up üî®</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/upload/binaries" class="sidebar-heading clickable"><span>3 - Upload ‚û°Ô∏è</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/use/rf" class="sidebar-heading clickable open"><span>4 - Use ‚úàÔ∏è</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/use/rf.html" class="sidebar-link">RF gateways  (433mhz/315mhz)</a></li><li><a href="/use/ble.html" class="active sidebar-link">BLE gateway</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/use/ble.html#receiving-signals-from-ble-beacon-devices-for-presence-detection" class="sidebar-link">Receiving signals from BLE beacon devices for Presence detection</a></li><li class="sidebar-sub-header"><a href="/use/ble.html#receiving-signals-mi-flora-mi-jia-device-lywds02-cleargrass-or-mi-scale" class="sidebar-link">Receiving signals Mi Flora/ Mi jia device/ LYWDS02, ClearGrass or Mi scale</a></li><li class="sidebar-sub-header"><a href="/use/ble.html#setting-a-white-or-black-list" class="sidebar-link">Setting a white or black list</a></li><li class="sidebar-sub-header"><a href="/use/ble.html#setting-the-time-between-scans-and-force-a-scan" class="sidebar-link">Setting the time between scans and force a scan</a></li><li class="sidebar-sub-header"><a href="/use/ble.html#other" class="sidebar-link">Other</a></li></ul></li><li><a href="/use/ir.html" class="sidebar-link">IR gateway</a></li><li><a href="/use/lora.html" class="sidebar-link">LORA gateway</a></li><li><a href="/use/gsm.html" class="sidebar-link">GSM 2G gateway</a></li><li><a href="/use/rfm69.html" class="sidebar-link">RFM69 gateway</a></li><li><a href="/use/sensors.html" class="sidebar-link">Sensors</a></li><li><a href="/use/actuators.html" class="sidebar-link">Actuators</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/integrate/openhab2/" class="sidebar-heading clickable"><span>5 - Integrate üéâ</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>6 - Participate üíª</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="ble-gateway"><a href="#ble-gateway" class="header-anchor">#</a> BLE gateway</h1> <h2 id="receiving-signals-from-ble-beacon-devices-for-presence-detection"><a href="#receiving-signals-from-ble-beacon-devices-for-presence-detection" class="header-anchor">#</a> Receiving signals from BLE beacon devices for Presence detection</h2> <p>Subscribe to all the messages with mosquitto or open your MQTT client software:</p> <p><code>sudo mosquitto_sub -t +/# -v</code></p> <p><em>NOTE: HM-10 or HM-11 module needed if you are not using ESP32; configure in <code>user_config.h</code></em></p> <p>The BT gateway module for OpenMQTTGateway enables the detection of BLE beacons and their signal strength.  Generally BLE devices will not broadcast if they are paired so you may need to ensure your beacons is unpaired before it will be seen by the gateway.</p> <p>If beacons are detected the gateway will periodically publish messages to MQTT (beacons must not be paired, see above):</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>home/OpenMQTTGateway/BTtoMQTT/45E174126E00 {&quot;id&quot;:&quot;45:e1:74:12:6e:00&quot;,&quot;rssi&quot;:-89,&quot;distance&quot;:21.51847,&quot;servicedata&quot;:&quot;fe0000000000000000000000000000000000000000&quot;}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>home/OpenMQTTGateway/BTtoMQTT/C7FaaD132C00 {&quot;id&quot;:&quot;c7:fa:ad:13:2c:00&quot;,&quot;rssi&quot;:-68,&quot;distance&quot;:2.799256,&quot;servicedata&quot;:&quot;drfgdrgdsrgesrdgdrgdregesrgtrhtyhtfyhdtyhh&quot;}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>The subtopic after <code>home/BTtoMQTT/</code> is the MAC address of the Bluetooth low energy beacon.  The rssi value is the <a href="https://www.metageek.com/training/resources/understanding-rssi.html" target="_blank" rel="noopener noreferrer">RSSI signal level<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> from which you may deduce the relative distance to the device.
Consider the distance as a beta featuer as currently we are not retrieving the emitting power of the beacon to make it more accurate.</p> <p>Note that you can find apps to simulate beacons and do some tests like <a href="https://play.google.com/store/apps/details?id=net.alea.beaconsimulator" target="_blank" rel="noopener noreferrer">Beacon simulator<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>IOS version &gt;=10 devices advertise without an extra app a mac address, nevertheless this address <a href="https://github.com/1technophile/OpenMQTTGateway/issues/71" target="_blank" rel="noopener noreferrer">changes randomly<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and cannot be used for presence detection. You must install an app to advertise a fixed MAC address.</p> <h2 id="receiving-signals-mi-flora-mi-jia-device-lywds02-cleargrass-or-mi-scale"><a href="#receiving-signals-mi-flora-mi-jia-device-lywds02-cleargrass-or-mi-scale" class="header-anchor">#</a> Receiving signals Mi Flora/ Mi jia device/ LYWDS02, ClearGrass or Mi scale</h2> <p>So as to receive BLE sensors data you need either a simple ESP32 either an ESP8266/arduino + HM10/11 with firmware &gt;= v601
The mi flora supported firmware is &gt;3.1.8</p> <p>Verify that your sensor is working with the App and update it with the last software version.
You should see in your MQTT broker the following data:
<img src="data:image/png;base64,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" alt=""></p> <p>Note that the gateway return one or two measurement value each time. The different measures depending on the devices are:</p> <ul><li>Lux</li> <li>Temperature</li> <li>Moisture</li> <li>Fertilization</li> <li>Weight</li> <li>Impedance</li> <li>Battery (mi jia only)</li></ul> <p>The infos will appear like this on your MQTT broker:</p> <p><code>home/OpenMQTTGateway/BTtoMQTT/4C33A6603C79 {&quot;hum&quot;:&quot;52.6&quot;,&quot;tem&quot;:&quot;19.2&quot;}</code></p> <p>More info are available on <a href="https://1technophile.blogspot.fr/2017/11/mi-flora-integration-to-openmqttgateway.html" target="_blank" rel="noopener noreferrer">my blog<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>  (especially about how it was implemented with HM10)</p> <h2 id="setting-a-white-or-black-list"><a href="#setting-a-white-or-black-list" class="header-anchor">#</a> Setting a white or black list</h2> <p>A black list is a list of mac adresses that will never be published by OMG
to set black list
<code>mosquitto_pub -t home/OpenMQTTGateway/commands/MQTTtoBT/set -m '{&quot;black-list&quot;:[&quot;012314551615&quot;,&quot;4C6577889C79&quot;,&quot;4C65A6663C79&quot;]}'</code></p> <p>A white list is a list of mac adresses permitted to be published by OMG
to set white list
<code>mosquitto_pub -t home/OpenMQTTGateway/commands/MQTTtoBT/set -m '{&quot;white-list&quot;:[&quot;012314551615&quot;,&quot;4C65A5553C79&quot;,&quot;4C65A6663C79&quot;]}'</code></p> <p>Note: if you want to filter (white or black list) on BLE sensors that are auto discovered, you need to wait for the discovery before applying the white or black list</p> <h2 id="setting-the-time-between-scans-and-force-a-scan"><a href="#setting-the-time-between-scans-and-force-a-scan" class="header-anchor">#</a> Setting the time between scans and force a scan</h2> <p>If you want to change the time between readings you can change the interval by MQTT, if you want the BLE scan every 66seconds:</p> <p><code>mosquitto_pub -t home/OpenMQTTGateway/commands/MQTTtoBT/set -m '{&quot;interval&quot;:66000}'</code></p> <p>you can also force a scan to be done by the following command:</p> <p><code>mosquitto_pub -t home/OpenMQTTGateway/commands/MQTTtoBT/set -m '{&quot;interval&quot;:0}'</code></p> <p>Once done the previous value of interval will be recovered.</p> <h2 id="other"><a href="#other" class="header-anchor">#</a> Other</h2> <p>To check your hm10 firmware version upload a serial sketch to the nodemcu (this will enable communication directly with the hm10) and launch the command:
<code>AT+VERR?</code></p> <p>More info about HM-10 is <a href="http://www.martyncurrey.com/hm-10-bluetooth-4ble-modules/" target="_blank" rel="noopener noreferrer">available here<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/1technophile/OpenMQTTGateway/edit/development/docs/use/ble.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">10/30/2019, 9:15:40 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ‚Üê
      <a href="/use/rf.html" class="prev">RF gateways  (433mhz/315mhz)</a></span> <span class="next"><a href="/use/ir.html">IR gateway</a>
      ‚Üí
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.55b55a57.js" defer></script><script src="/assets/js/2.e0da9a0a.js" defer></script><script src="/assets/js/15.6c1a5c94.js" defer></script>
  </body>
</html>
